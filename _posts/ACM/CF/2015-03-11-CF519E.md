---
title: CF 519E 
layout: post
category:
tags:
---


题意：给出一个无向无环连通图(点数n <= 10^5)，求到任意两点u,v距离相等的点的个数，共有m (m <= 10^5)次询问。


分析：对于u,v首先求出它们的最近公共祖先lca(u,v),若它们到最近公共祖先距离之和为奇数，则答案为0，否则u到v的路径上存在一个点w到二者距离相等，而且从w向外扩展不经过u，v的子树也都满足条件。对原图进行dfs，将无向图图转化成一棵深搜树，再预处理出来size[u]，表示以u为根节点的子树的大小，dep[u],表示u在深度优先搜索树中的深度。
